<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>

{% comment %} --- CORRECTED AND FINAL HYBRID LOGIC --- {% endcomment %}

{% if site.r2_video_url and site.r2_video_url != "" %}
    
    {% comment %} An R2 URL is defined. ONLY run this block and ignore all local file logic. {% endcomment %}
    <script>
        $(function() {
            // Ensure the screenshot is hidden
            $(".iphoneScreen").addClass("hidden");

            // Ensure the video container is visible
            $(".videoContainer").removeClass("hidden");
            
            // Add the R2 video source and log success to the console
            $(".screenvideo").append('<source src="{{ site.r2_video_url }}" type="video/mp4">');
            console.log("SUCCESS: Displaying R2 brand video: {{ site.r2_video_url }}");
        });
    </script>

{% else %}

    {% comment %} --- FALLBACK TO OLD LOGIC --- {% endcomment %}
    {% comment %} No R2 URL was found. Run the original logic to find local screenshots or videos. {% endcomment %}
    {% for file in site.static_files %}
        {% if file.path contains 'assets/screenshot/' %}
            <script>
                $(function() {
                    $(".iphoneScreen").attr('src', '{{ site.github.baseurl }}{{ file.path }}');
                    $(".iphoneScreen").removeClass("hidden");
                    console.log("FALLBACK: Displaying local screenshot: {{ file.path }}");
                });
            </script>
        {% elsif file.path contains 'assets/videos/' %}
            {% unless file.path contains 'assets/videos/Place-video-files-here.txt' %}
                <script>
                    $(function() {
                        $(".iphoneScreen").addClass("hidden");
                        console.log("FALLBACK: Hiding screenshot to show local video.");
                    });
                </script>
            {% endunless %}
            {% if file.extname == ".mov" or file.extname == ".mp4" %}
                <script>
                    $(function() {
                        $(".videoContainer").removeClass("hidden");
                        $(".screenvideo").append('<source src="{{ site.github.baseurl }}{{ file.path }}" type="video/mp4">');
                        console.log("FALLBACK: Using local video: {{ file.path }}");
                    });
                </script>
            {% endif %}
        {% endif %}
    {% endfor %}

{% endif %}