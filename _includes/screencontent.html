<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>

{# --- NEW HYBRID LOGIC --- #}
{# First, check if a brand-specific R2 video URL is defined in _config.yml #}
{% if site.r2_video_url %}

    {# The R2 URL exists. We will use it and ignore the local file search for videos. #}
    <script>
        $(function() {
            // Hide the screenshot area since we are showing the brand video
            $(".iphoneScreen").addClass("hidden");
            
            // Show the video container
            $(".videoContainer").removeClass("hidden");
            
            // Append the video source using the URL from the config file
            $(".screenvideo").append('<source src="{{ site.r2_video_url }}" type="video/mp4">');

            console.log("Using R2 brand video: {{ site.r2_video_url }}");
        });
    </script>
    {# We can also still search for local screenshots if needed #}
    {% for file in site.static_files %}
        {% if file.path contains 'assets/screenshot/' %}
            <script>
                $(function() {
                    // This logic remains in case a screenshot should override the video,
                    // or if they can be displayed simultaneously depending on your site's design.
                    // If the video should ALWAYS be shown when present, you might not need this part.
                    $(".iphoneScreen").attr('src', '{{ site.github.baseurl }}{{ file.path }}');
                    $(".iphoneScreen").removeClass("hidden");
                    $(".videoContainer").addClass("hidden"); // Hide video if screenshot is found
                    console.log("Displaying local screenshot: {{ file.path }}");
                });
            </script>
        {% endif %}
    {% endfor %}

{% else %}

    {# --- FALLBACK TO OLD LOGIC --- #}
    {# If no r2_video_url is set, run the original code to find local assets. #}
    {% for file in site.static_files %}
        {% if file.path contains 'assets/screenshot/' %}
            <script>
                $(function() {
                    $(".iphoneScreen").attr('src', '{{ site.github.baseurl }}{{ file.path }}');
                    $(".iphoneScreen").removeClass("hidden");
                    console.log("{{ file.path }}");
                });
            </script>
        {% elsif file.path contains 'assets/videos/' %}
            {% unless file.path contains 'assets/videos/Place-video-files-here.txt' %}
                <script>
                    $(function() {
                        $(".iphoneScreen").addClass("hidden");
                        console.log("remove screenshot");
                    });
                </script>
            {% endunless %}
            {% if file.extname == ".mov" or file.extname == ".mp4" %}
                <script>
                    $(function() {
                        $(".videoContainer").removeClass("hidden");
                        $(".screenvideo").append('<source src="{{ site.github.baseurl }}{{ file.path }}" type="video/mp4">');
                        console.log("{{ file.path }}");
                    });
                </script>
            {% elsif file.extname == ".ogg" %}
                <script>
                    $(function() {
                        $(".videoContainer").removeClass("hidden");
                        $(".screenvideo").append('<source src="{{ site.github.baseurl }}{{ file.path }}" type="video/ogg">');
                        console.log("{{ file.path }}");
                    });
                </script>
            {% elsif file.extname == ".webm" %}
            <script>
                $(function() {
                    $(".videoContainer").removeClass("hidden");
                    $(".screenvideo").append('<source src="{{ site.github.baseurl }}{{ file.path }}" type="video/webm">');
                    console.log("{{ file.path }}");
                });
            </script>
            {% endif %}
        {% endif %}
    {% endfor %}

{% endif %}
